<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TP 8 – Canvas & sprites animés</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .analyse-header {
            background: #ffffff;
            padding: 40px 20px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        .analyse-header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .analyse-header .subtitle {
            font-size: 1.1rem;
            color: #666;
        }
        .analyse-content {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }
        .analyse-section {
            background: #ffffff;
            padding: 25px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        .analyse-section h2 {
            margin-bottom: 15px;
            color: #4b6786;
            font-size: 1.4rem;
        }
        .analyse-section p {
            margin-bottom: 10px;
        }
        .analyse-section ul {
            padding-left: 20px;
        }
        .analyse-section li {
            margin-bottom: 8px;
        }
        .exercise-card {
            background: #f7f8fa;
            border-left: 4px solid #4b6786;
            padding: 15px 15px 10px 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .exercise-card h3 {
            margin-bottom: 8px;
            color: #4b6786;
            font-size: 1.1rem;
        }
        footer {
            text-align: center;
            padding: 30px 20px;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4b6786;
            color: #ffffff;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <!-- HEADER / MENU -->
    <nav class="main-navbar">
        <div class="hamburger-btn" id="hamburgerBtn">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <a href="index.html" class="nav-logo">Yasmine EL HAMBLI</a>

        <div class="side-menu" id="sideMenu">
            <div class="close-btn" id="closeBtn">&times;</div>

            <ul class="menu-list">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="#synthese-section">Synthèse</a></li>

                <hr class="separator">

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 1 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp1ex1.html">Exercice 1</a></li>
                        <li><a href="tp1ex2.html">Exercice 2</a></li>
                        <li><a href="tp1_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 2 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp2ex1.html">Exercice 1</a></li>
                        <li><a href="tp2ex2.html">Exercice 2</a></li>
                        <li><a href="tp2_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 3 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp3ex1.html">Exercice 1</a></li>
                        <li><a href="tp3ex2.html">Exercice 2</a></li>
                        <li><a href="tp3_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 4 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp4ex2.html">Exercice 2</a></li>
                        <li><a href="tp4ex3.html">Exercice 3</a></li>
                        <li><a href="tp4_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 5 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp5ex1.html">Exercice 1</a></li>
                        <li><a href="tp5ex6.html">Exercice 6 (Imposé)</a></li>
                        <li><a href="tp5_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 6 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp6ex1.html">Exercice 1</a></li>
                        <li><a href="tp6ex5.html">Exercice 5 (Imposé)</a></li>
                        <li><a href="tp6_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 7 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp7ex1.html">Exercice 1</a></li>
                        <li><a href="tp7ex3.html">Exercice 3</a></li>
                        <li><a href="tp7_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>

                <li class="dropdown-item">
                    <button class="dropdown-btn">TP 8 <span class="arrow">▼</span></button>
                    <ul class="submenu">
                        <li><a href="tp8ex1.html">Exercice 1</a></li>
                        <li><a href="tp8ex2.html">Exercice 2</a></li>
                        <li><a href="tp8_analyse.html">Analyse du TP</a></li>
                    </ul>
                </li>
            </ul>
        </div>

        <div class="overlay" id="overlay"></div>
    </nav>

    <header class="analyse-header">
        <h1>TP 8 – Canvas & sprites animés</h1>
        <p class="subtitle">Déplacement de sprites, scrolling et manipulation d’images sur le canvas</p>
    </header>

    <main class="analyse-content">

        <section class="analyse-section">
            <h2>Vue d’ensemble du TP</h2>
            <p>Le TP 8 explore l’élément <strong>canvas</strong> en JavaScript et son contexte 2D pour créer des scènes interactives proches du jeu vidéo.</p>
            <p>Les exercices vont du simple déplacement d’un sprite avec le clavier jusqu’à des effets d’image plus avancés comme la loupe, l’affichage de la couleur d’un pixel ou la conversion en niveaux de gris.</p>
        </section>

        <section class="analyse-section">
            <h2>Connaissances techniques mobilisées</h2>
            <ul class="skills-list">
                <li>Création et récupération d’un <strong>canvas</strong> avec <code>getContext("2d")</code>.</li>
                <li>Chargement d’images en JavaScript avec <code>new Image()</code> et utilisation de <code>onload</code> pour démarrer l’animation.</li>
                <li>Découpage d’une spritesheet en utilisant correctement les paramètres de <code>drawImage()</code> (source x/y, largeur/hauteur, destination x/y).</li>
                <li>Animation image par image via une boucle <code>requestAnimationFrame()</code> combinée à des fonctions <code>update()</code> et <code>draw()</code>.</li>
                <li>Gestion du clavier (événements <code>keydown</code> / <code>keyup</code>) pour déplacer un personnage tout en changeant de frame.</li>
                <li>Gestion des coordonnées de la souris pour déclencher des animations ou récupérer la couleur d’un pixel cliqué.</li>
                <li>Manipulation des données de pixels (tableaux r, v, b, a) pour créer un effet de niveaux de gris.</li>
            </ul>
        </section>

        <section class="analyse-section">
            <h2>Résumé des exercices réalisés</h2>

            <div class="exercise-card">
                <h3>Exercice 1 – Déplacement d’un sprite</h3>
                <p><strong>Objectif :</strong> Déplacer un personnage dans un canvas 512 × 512 avec les touches directionnelles en changeant l’image affichée suivant la direction.</p>
                <p><strong>Points clés :</strong> calcul de la position (x, y), choix de la bonne ligne dans la spritesheet selon la direction, gestion des limites pour empêcher le personnage de sortir du canvas.</p>
                <p><strong>Difficulté ressentie :</strong> moyenne – demande surtout de bien comprendre les coordonnées dans la spritesheet.</p>
            </div>

            <div class="exercise-card">
                <h3>Exercice 2 – Mario et fond défilant</h3>
                <p><strong>Objectif :</strong> Faire courir Mario dans un canvas 600 × 480 pendant qu’un décor de fond défile en boucle horizontalement.</p>
                <p><strong>Points clés :</strong> création d’un scrolling infini en décalant la position x de l’arrière-plan, alternance des frames de Mario pour donner une impression de course, synchronisation entre la vitesse du fond et l’animation du personnage.</p>
                <p><strong>Difficulté ressentie :</strong> plutôt élevée – il faut combiner mouvement du décor, animation du sprite et boucle d’animation fluide.</p>
            </div>

            <div class="exercise-card">
                <h3>Exercices 3 à 6 – Interactions avec les images</h3>
                <p><strong>Objectif :</strong> Réagir aux clics dans le canvas (goutte, affichage de la couleur du pixel), créer un effet de loupe et transformer une image en niveaux de gris.</p>
                <p><strong>Points clés :</strong> maîtrise des coordonnées souris/canvas, utilisation de <code>getImageData()</code> et <code>putImageData()</code>, boucle sur les pixels pour calculer la moyenne des composantes r, v, b et générer la version en niveaux de gris.</p>
            </div>
        </section>

        <section class="analyse-section">
            <h2>Difficultés rencontrées</h2>
            <ul class="challenges-list">
                <li>Comprendre les nombreux paramètres de <code>drawImage()</code> pour découper correctement les sprites et les afficher à la bonne taille.</li>
                <li>Organiser proprement la boucle de jeu avec <code>update()</code> et <code>draw()</code> pour éviter les bugs d’affichage ou les effets de “flicker”.</li>
                <li>Gérer les limites du canvas lors du déplacement du personnage, surtout avec une vitesse fixe en pixels.</li>
                <li>Bien convertir les coordonnées de la souris en coordonnées dans l’image pour obtenir la bonne couleur de pixel.</li>
                <li>Manipuler les tableaux de pixels (beaucoup de valeurs, gestion de l’index r, v, b, a) sans se tromper d’indice.</li>
            </ul>
        </section>

        <section class="analyse-section">
            <h2>Qualité du résultat obtenu</h2>
            <p>Globalement, les animations fonctionnent : le personnage se déplace correctement, le fond défile et les interactions avec les images réagissent comme prévu.</p>
            <p>Le rendu est satisfaisant pour un premier TP sur le canvas, même si certains aspects peuvent encore être améliorés (fluidité de l’animation, centrage du canvas dans la page, optimisation du code pour les pixels).</p>
        </section>

        <section class="analyse-section">
            <h2>Intérêt pour mon apprentissage</h2>
            <p>Ce TP est très intéressant car il montre comment passer d’une page web “classique” à une scène animée interactive, proche d’un mini jeu vidéo.</p>
            <p>Il m’a permis de mieux comprendre le lien entre JavaScript, les images et l’affichage en temps réel, ce qui est utile pour des projets créatifs (jeux, visualisations, effets graphiques sur un site).</p>
        </section>

        <section class="analyse-section">
            <h2>Pistes d’amélioration personnelles</h2>
            <ul>
                <li>Nettoyer et commenter davantage le code pour séparer clairement la gestion des entrées, la logique de jeu et l’affichage.</li>
                <li>Ajouter des éléments d’interface sur le canvas (score, temps, vies, etc.).</li>
                <li>Tester différentes vitesses d’animation et utiliser éventuellement un delta de temps pour rendre le jeu indépendant du nombre de FPS.</li>
                <li>Expérimenter d’autres filtres d’image au‑delà des niveaux de gris (teinte, saturation, contraste).</li>
            </ul>
        </section>

    </main>

    <footer>
        <a href="index.html" class="back-btn">← Retour à l'accueil</a>
    </footer>

    <!-- SCRIPT MENU -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const closeBtn = document.getElementById('closeBtn');
        const sideMenu = document.getElementById('sideMenu');
        const overlay = document.getElementById('overlay');

        function toggleMenu() {
            sideMenu.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        hamburgerBtn.addEventListener('click', toggleMenu);
        closeBtn.addEventListener('click', toggleMenu);
        overlay.addEventListener('click', toggleMenu);

        const dropdownBtns = document.querySelectorAll('.dropdown-btn');
        dropdownBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                this.classList.toggle('open');
                const submenu = this.nextElementSibling;
                if (submenu.style.maxHeight) {
                    submenu.style.maxHeight = null;
                } else {
                    submenu.style.maxHeight = submenu.scrollHeight + "px";
                }
            });
        });
    });
    </script>

</body>
</html>
